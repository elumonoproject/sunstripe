<!DOCTYPE html>
<html lang="ja">
    <head>
        <title>JavaScript スタイルシートリファレンス</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="author" content="You Ohshima" />
        <meta name="keywords" content="セミナー,クリエーター,紹介,制作,仲間" />
        <meta name="description" content="才能をやりたいように表現するサンストライプ-オフィシャルサイト。" />
        <link rel="stylesheet" href="./css/styles.css" type="text/css" />
        <link rel="stylesheet" href="./css/displayTableList.css" type="text/css" />
        <script type="text/javascript" src="./js/cssdata.js"></script>
        <script type="text/javascript" src="./js/displayTableList.js"></script>
    </head>
    <body>
        <div id="wrapper">
            <h1>JavaScript - Function クロージャについて</h1>
            <h2>JavaScriptリファレンス</h2>
            <div id="ad1">
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- レクタングル（大） -->
                <ins class="adsbygoogle"
                    style="display:inline-block;width:320px;height:280px"
                    data-ad-client="ca-pub-1616619771436459"
                    data-ad-slot="5900513788"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
            </div>
            
            <div id="scriptProperties">
            </div>
            <!--/ #scriptProperties-->
            <br />
            <h4>クロージャについて</h4>
            <div id="scriptElements">
                
                <!-- start //-->
                
                <!-- MyFunction1 //-->
                
                <h3 id="closure">クロージャについて･････</h3>
                
                <h4>スコープとは？</h4>
                <pre>
                    スコープとは、<span class="color-red">宣言した変数や関数などに対する、アクセス可能な範囲</span> の事です。
                </pre>
                <pre>
                    任意のスコープ内で、変数や関数を宣言した場合、スコープの内側から自由にアクセスできます。
                    　
                    しかし、スコープの外側からアクセスする事はできません。
                </pre>
                
                <h4>スコープを利用するためには？</h4>
                <pre>
                    ECMAScript では、<span class="color-red">中括弧 { }</span> を記述しただけでは、スコープとして機能しません。
                </pre>
                
                <pre>
                    例えば、以下のソースは、スコープとして機能しません。
                    　
                    <span class="color-red">中括弧 { }</span> を記述していない時と、同じ動作をします。
                </pre>
                
                <h5><a href="#MyFunction1">中括弧 { } を記述しただけでは、スコープとして機能しない</a>･････</h5>
                
                <!-- MyFunction2 //-->
                
                <h4>関数は スコープとして機能する</h4>
                <pre>
                    <span class="color-red">ECMAScript では、関数を利用すると、スコープとして機能します。</span>
                </pre>
                
                <h5><a href="#MyFunction2">関数は、スコープとして機能する</a>･････</h5>
                
                <!-- MyFunction3 //-->
                
                <h4>ローカル変数について</h4>
                
                <pre>
                    関数内で変数を宣言すると、<span class="color-red">ローカル変数</span>を作成することができます。
                    　
                    通常であれば、ローカル変数は、<span class="color-red">スコープの外に出ると消滅</span>します。
                </pre>
                
                <h5><a href="#MyFunction3">関数の中で変数を宣言すると、ローカル変数となる</a>･････</h5>
                
                <!-- MyFunction4 //-->
                
                <h4>ローカル関数について</h4>
                
                <pre>
                    任意の関数の中では、<span class="color-red">関数を宣言</span>したり、<span class="color-red">動的に関数を作成</span>することができます。
                    　
                    任意のスコープ内で作られた関数を、<span class="color-red">ローカル関数</span>と言います。
                </pre>
                　
                <pre>
                    ローカル関数の中からは、<span class="color-red">同じスコープ内</span>と<span class="color-red">スコープの外側に存在する環境</span>にアクセスする事ができます。
                </pre>
                
                <h5><a href="#MyFunction4">関数の中からは、同じスコープ内と、スコープの外側に存在する環境にアクセスできる</a>･････</h5>
                
                <!-- MyFunction5 //-->
                
                <h4>ローカル関数をスコープの外側に持ち出した場合</h4>
                
                <pre>
                    ローカル関数は、オブジェクトの一種なので、<span class="color-red">スコープの外に持ち出す</span>ことができます。
                    　
                    スコープの内側で作成した関数オブジェクトを、スコープの外側から実行します。
                </pre>
                　
                <pre>
                    この場合、スコープ内の環境は消滅していません。
                    　
                    <span class="color-red">関数オブジェクトが消滅しない限り、スコープ内の環境も生存し続けます</span>。
                </pre>
                
                <h5><a href="#MyFunction5">スコープの中で作成した関数オブジェクトを、スコープの外から実行する</a>･････</h5>
                
                <!-- MyFunction6 //-->
                
                <h4>クロージャとは？</h4>
                
                <pre>
                    任意の関数が生存していれば、その関数内からアクセスできるすべての環境も生存し続けます。
                    　
                    この仕様を、<span class="color-red">クロージャ</span>といいます。
                </pre>
                
                <pre>
                    <span class="color-red">引数の変数</span>も、ローカル変数として扱われるため、生存し続けます。
                </pre>
                　
                <h5><a href="#MyFunction5">引数の変数もローカル変数なので、生存し続ける</a>･････</h5>
                
                <!-- MyFunction7 //-->
                
                <!-- >
                 // h3 見出し
                 <h3>見出し</h4>
                 
                 // h4 小見出し
                 <h4>小見出し</h4>
                 
                 // pre 説明文
                 <pre>
                 説明文
                 　
                 <span class="color-red">強調文字</span> 説明文
                 </pre>
                 
                 // h5 javascript a-link
                 <h5><a href="#MyFunction1">中括弧 { } を記述しただけでは、スコープとして機能しない</a>･････</h5>
                 </ //-->
                <!--script>
                 // method
                 var function_method = {
                 //"title":"◯◯◯◯◯ クラスには、以下のメソッドがあります。(一部抜粋)",
                 "list":[
                 {
                 "method":"<a href='#'>method()</a>",
                 "description":"メソッド説明",
                 },
                 ],
                 };
                 displayTableList(function_method);
                 
                 </script // -->
                
                <!-- script>
                 
                 // function
                 var function_method_tablelist = {
                 "title":"Function.method ( this , [ 引数 ] ) :*",
                 "list":[
                 {
                 "title":"第01引数(略可)",
                 "type":"Object",
                 "description":"説明文",
                 },
                 {
                 "title":"第02引数(略可)",
                 "type":"Object",
                 "description":"説明文",
                 },
                 {
                 "title":"戻り値",
                 "type":"*",
                 "description":"戻り値説明文",
                 },
                 ],
                 };
                 displayTableList(function_method_tablelist);
                 
                 </script // -->
                
                <!-- end //-->
                
            </div>
            <!--/ #scriptElements-->
            
            <div id="ad2">
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- リンクユニット（小　モバイル用） -->
                <ins class="adsbygoogle"
                    style="display:inline-block;width:320px;height:50px"
                    data-ad-client="ca-pub-1616619771436459"
                    data-ad-slot="9019374983"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
            </div>
            
            <h4>使用例</h4>
            <h5>外部ファイル（CreateFunction.js）</h5>
            <div id="scriptUseExsample">
                <pre id="scriptOutput"></pre>
                <script id="scriptInput">
                    
                    // ------------------------------------------------------------
                    // MyFunction1
                    // ------------------------------------------------------------
                    
                    document.writeln ('<hr />');
                    document.write ('<a name="MyFunction1">中括弧 { } を記述しただけでは、スコープとして機能しない</a>');
                    document.writeln ('<hr />');
                    
                    {
                        // 変数を宣言
                        var aaa = 1;
                        var bbb = 2;
                        var ccc = 3;
                    }
                
                // 出力テスト（外側からアクセスできるのでスコープではない）
                console.log ('aaa : ' + aaa); // 1
                console.log ('bbb : ' + bbb); // 2
                console.log ('ccc : ' + ccc); // 3
                document.write ('aaa : ' + aaa);
                document.write ('bbb : ' + bbb);
                document.write ('ccc : ' + ccc);
                
                
                // ------------------------------------------------------------
                // MyFunction2
                // ------------------------------------------------------------
                
                document.writeln ('<hr />');
                document.write ('<a name="MyFunction2">関数は、スコープとして機能する</a>');
                document.writeln ('<hr />');
                
                // ------------------------------------------------------------
                // MyFunc という名前の関数を宣言する
                // ------------------------------------------------------------
                function MyFunction2 () {
                    // 関数内で変数を宣言
                    var ddd = 1;
                    var eee = 2;
                    var fff = 3;
                    
                    // 出力テスト（○ アクセス可能）
                    console.log(ddd); // 1
                    console.log(eee); // 2
                    console.log(fff); // 3
                    document.write ('ddd : ' + ddd);
                    document.write ('eee : ' + eee);
                    document.write ('fff : ' + fff);
                    document.writeln ('<br />');
                }
                
                // ------------------------------------------------------------
                // MyFunction2 関数を実行する
                // ------------------------------------------------------------
                MyFunction2();
                
                // ------------------------------------------------------------
                // アクセステスト（× 関数スコープの外側からアクセスできない）
                // ------------------------------------------------------------
                try {
                    
                    console.log(ddd);
                    console.log(eee);
                    console.log(fff);
                    document.write ('ddd : ' + ddd);
                    document.write ('eee : ' + eee);
                    document.write ('fff : ' + fff);
                    document.writeln ('<br />');
                    
                    
                } catch (error) {
                    
                    console.log('error : ' + error);
                    document.write ('error : ' + error);
                    
                }
                // ------------------------------------------------------------
                // MyFunction3
                // ------------------------------------------------------------
                
                document.writeln ('<hr />');
                document.write ('<a name="MyFunction3">関数の中で変数を宣言すると、ローカル変数となる</a>');
                document.writeln ('<hr />');
                
                // ------------------------------------------------------------
                // MyFunction3 という名前の関数を宣言する
                // ------------------------------------------------------------
                function MyFunction3() {
                    
                    // ローカル変数を宣言 (関数内で変数を宣言しているのでローカル変数となる)
                    var local_val;
                    var local_str;
                    
                    local_val = 123;
                    local_str = "あいうえお";
                    console.log ('local_val : ',local_val);
                    console.log ('local_str : ',local_str);
                    document.write ('local_val : ',local_val);
                    document.write ('local_str : ',local_str);
                }
                
                MyFunction3 ();
                
                // ------------------------------------------------------------
                // MyFunction4
                // ------------------------------------------------------------
                
                document.writeln ('<hr />');
                document.write ('<a name="MyFunction4">関数の中からは、同じスコープ内と、スコープの外側に存在する環境にアクセスできる</a>');
                document.writeln ('<hr />');
                
                // ------------------------------------------------------------
                // グローバル変数を宣言
                // ------------------------------------------------------------
                var global_a = "aaa";
                var global_b = "bbb";
                
                // ------------------------------------------------------------
                // MyFunction4_Global という名前の関数を宣言する（グローバルな関数）
                // ------------------------------------------------------------
                function MyFunction4_Global() {
                    
                    // ------------------------------------------------------------
                    // ローカル変数を宣言
                    // ------------------------------------------------------------
                    var local_a0 = "ccc";
                    var local_a1 = "ddd";
                    
                    // ------------------------------------------------------------
                    // MyFunc_L という名前の関数を宣言する（関数の中で、さらに関数を宣言しているのでローカル関数となる）
                    // ------------------------------------------------------------
                    function MyFunction4_Local() {
                        
                        // ------------------------------------------------------------
                        // ローカル変数を宣言
                        // ------------------------------------------------------------
                        var local_b0 = "eee";
                        var local_b1 = "fff";
                        
                        // ------------------------------------------------------------
                        // アクセステスト
                        // ------------------------------------------------------------
                        // スコープの外側に存在する環境にアクセスできる
                        console.log(global_a); // "aaa"
                        console.log(global_b); // "bbb"
                        console.log(local_a0); // "ccc"
                        console.log(local_a1); // "ddd"
                        document.write ('global_a : ',global_a);
                        document.write ('global_b : ',global_b);
                        document.write ('local_a0 : ',local_a0);
                        document.write ('local_a1 : ',local_a1);
                        
                        // 同じスコープ内の環境にアクセスできる
                        console.log(local_b0); // "eee"
                        console.log(local_b1); // "fff"
                        document.write ('local_b0 : ',local_b0);
                        document.write ('local_b1 : ',local_b1);
                    }
                    
                    // ------------------------------------------------------------
                    // MyFunction4_Local 関数を実行する
                    // ------------------------------------------------------------
                    MyFunction4_Local();
                }
                
                // ------------------------------------------------------------
                // MyFunction4_Global 関数を実行する
                // ------------------------------------------------------------
                MyFunction4_Global();
                
                // ------------------------------------------------------------
                // MyFunction5
                // ------------------------------------------------------------
                
                document.writeln ('<hr />');
                document.write ('<a name="MyFunction5">スコープの中で作成した関数オブジェクトを、スコープの外から実行する</a>');
                document.writeln ('<hr />');
                
                // ------------------------------------------------------------
                // MyFunction5_Global という名前の関数を宣言する（グローバルな関数）
                // ------------------------------------------------------------
                function MyFunction5_Global() {
                    
                    // ------------------------------------------------------------
                    // ローカル変数を宣言
                    // ------------------------------------------------------------
                    var local_a = "aaa";
                    var local_b = "bbb";
                    
                    // ------------------------------------------------------------
                    // MyFunction5_Local という名前の関数を宣言する（ローカル関数）
                    // ------------------------------------------------------------
                    function MyFunction5_Local() {
                        
                        // アクセステスト
                        console.log(local_a); // "aaa"
                        console.log(local_b); // "bbb"
                        document.write ('local_a : ',local_a);
                        document.write ('local_b : ',local_b);
                    }
                    
                    // ------------------------------------------------------------
                    // MyFunction5_Local 関数オブジェクトを返す
                    // ------------------------------------------------------------
                    return MyFunction5_Local;
                }
                
                // ------------------------------------------------------------
                // MyFunction5_Global 関数を実行して、新しい関数オブジェクトを取得する
                // ------------------------------------------------------------
                var function5_object = MyFunction5_Global();
                
                // ------------------------------------------------------------
                // 関数オブジェクトを実行する（MyFunction5_Global 関数のスコープ内の環境は、生存し続けている）
                // ------------------------------------------------------------
                function5_object();
                
                // ------------------------------------------------------------
                // MyFunction6
                // ------------------------------------------------------------
                
                document.writeln ('<hr />');
                document.write ('<a name="MyFunction6">引数の変数もローカル変数なので、生存し続ける</a>');
                document.writeln ('<hr />');
                
                // ------------------------------------------------------------
                // MyFunction6 という名前の関数を宣言する（グローバルな関数）
                // ------------------------------------------------------------
                function MyFunction6 (name) {
                    
                    // ------------------------------------------------------------
                    // ローカル変数を宣言
                    // ------------------------------------------------------------
                    var count = 0;
                    
                    // ------------------------------------------------------------
                    // 関数オブジェクトを動的に作成して返す
                    // ------------------------------------------------------------
                    return function () {
                        // 出力テスト
                        console.log('name : ' + name + ' count : ' + count);
                        document.write ('name : ' + name + ' count : ' + count);
                        document.writeln ('<br />');
                        // カウント
                        count++;
                    };
                }
                
                // ------------------------------------------------------------
                // MyFunction6 関数を実行して、新しく関数を生成する
                // ------------------------------------------------------------
                var function6_object0 = MyFunction6('テスト１');
                var function6_object1 = MyFunction6('テスト２');
                var function6_object2 = MyFunction6('テスト３');
                
                // ------------------------------------------------------------
                // 実行テスト
                // ------------------------------------------------------------
                function6_object0(); // name:"テスト１" count:0
                function6_object1(); // name:"テスト２" count:0
                function6_object2(); // name:"テスト３" count:0
                function6_object2(); // name:"テスト３" count:1
                function6_object2(); // name:"テスト３" count:2
                function6_object2(); // name:"テスト３" count:3
                function6_object1(); // name:"テスト２" count:1
                function6_object2(); // name:"テスト３" count:4
                
                    </script>
            </div>
            <!--/ #cssUseExsample-->
            <h4>HTML</h4>
            <h5>外部ファイル（sample.html）</h5>
            <div id="htmlSourceCode">
                <pre id="htmlOutput">
                </pre>
            </div>
            <!--/ #htmlSourceCode-->
            <br />
            <div id="htmlUseExsample">
                <h4>ブラウザ上の表示</h4>
                <div id="htmlInput">
                    <script type="text/javascript" src="./js/CreateFunction.js"></script>
                </div>
            </div>
            <div id="ad3">
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- レクタングル（中） -->
                <ins class="adsbygoogle"
                    style="display:inline-block;width:300px;height:250px"
                    data-ad-client="ca-pub-1616619771436459"
                    data-ad-slot="1714745781"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
            </div>
            
            <!--/ #htmlUseExsample-->
            <h4>関連</h4>
            <div id="htmlList">
            </div>
            <!--/ #htmlList-->
            <script>
                var page = "";
                var htmlList = document.getElementById("htmlList");
                for(var l = 0; l < htmlData.links.length;l++){
                    var html = "";
                    var title = htmlData.links[l].title;
                    if(page == ""){
                        html += "<br />";
                        html += "<h5>" + title + "</h5>";
                        var items = htmlData.links[l].items;
                        for(var i = 0;i < items.length;i++){
                            html += items[i].title.link(items[i].url) + "<br />";
                        }
                        htmlList.innerHTML += html;
                    } else if(page != title && page != ""){
                        
                    } else {
                        var items = htmlData.links[l].items;
                        html += "<br />";
                        for(var i = 0;i < items.length;i++){
                            html += items[i].title.link(items[i].url) + "<br />";
                        }
                        htmlList.innerHTML += html;
                    }
                }
            var scriptOutput = document.getElementById("scriptOutput");
            var scriptInput = document.getElementById("scriptInput");
            scriptOutput.innerHTML = scriptInput.innerHTML;
            var htmlOutput = document.getElementById("htmlOutput");
            var htmlInput = document.getElementById("htmlInput");
            var input = htmlInput.innerHTML;
            var re = /</gi;
            input = input.replace(re, "&#60;");
            re = />/gi;
            input = input.replace(re, "&#62;");
            htmlOutput.innerHTML = input;
                </script>
            <div id="ad4">
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- リンクユニット縦長(特大) -->
                <ins class="adsbygoogle"
                    style="display:inline-block;width:200px;height:90px"
                    data-ad-client="ca-pub-1616619771436459"
                    data-ad-slot="2120848581"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
            </div>
            
            <footer>
                <address>
                    &copy; <a href="http://sunstripe.main.jp/">Team. SunStripe</a> - <a href="http://sunstripe.main.jp/books/javascript/">JavaScript リファレンス</a>
                </address>
            </footer>
        </div>
        <!--/ #wrapper-->
    </body>
</html>