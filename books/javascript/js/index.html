<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script>
        var data = {
            "links":[
                     
                     {
                     "title":"関数について（Function）",
                     "items":[
                              {
                              "title":"Function クラスについて",
                              "url":"about-function.html",
                              },
                              {
                              "title":"関数を作成する",
                              "url":"create-function.html",
                              },
                              {
                              "title":"Function クラスのプロパティについて",
                              "url":"property-function.html",
                              },
                              {
                              "title":"Function クラスのメソッドについて",
                              "url":"method-function.html",
                              },
                              {
                              "title":"クロージャについて",
                              "url":"closure-function.html",
                              },
                              {
                              "title":"コンストラクタ関数について",
                              "url":"constructor-function.html",
                              },
                              {
                              "title":"プロトタイプについて",
                              "url":"prototype-function.html",
                              },
                              ],
                     },
                     
                     ],
        };
        </script>
    </head>
    <body>
        <p>
        <textarea id="jsonData" style="width:100%;height:500px;" onChange="changeJsondata(2);">
        </textarea>
        </p>
        <p>
        <textarea id="encodeURIComponent" style="width:100%;height:500px;">
        </textarea>
        </p>
        <p>
        <textarea id="jsonParse" style="width:100%;height:500px;">
        </textarea>
        </p>
        <p>
        <textarea id="decodeURIComponent" style="width:100%;height:500px;">
        </textarea>
        </p>
        <script>
            function changeJsondata(flag) {
                var storage = sessionStorage;
                var encodeURIC = "";
                try {
                    if (1 == flag) {
                        //sessionDataがある場合
                        var sessionData = storage.getItem('sessionData');
                        if ( sessionData ) {
                            data = JSON.parse(decodeURIComponent(sessionData));
                            alert("Get Data");
                            var jsonData = JSON.stringify(data);
                            document.getElementById("jsonData").value = jsonData;
                            encodeURIC = encodeURIComponent(JSON.stringify(data));
                            document.getElementById("encodeURIComponent").value = encodeURIC;
                            document.getElementById("decodeURIComponent").value = decodeURIComponent(encodeURIC);
                            document.getElementById("jsonParse").value = JSON.parse(decodeURIComponent(encodeURIC));
                            
                        } else {
                            alert("New Data");
                            var jsonData = JSON.stringify(data);
                            document.getElementById("jsonData").value = jsonData;
                            encodeURIC = encodeURIComponent(JSON.stringify(data));
                            document.getElementById("encodeURIComponent").value = encodeURIC;
                            document.getElementById("decodeURIComponent").value = decodeURIComponent(encodeURIC);
                            document.getElementById("jsonParse").value = JSON.parse(decodeURIComponent(encodeURIC));
                        }
                    } else if (0 == flag) {
                        alert("Clear Data");
                        //useridというキーの値を削除する
                        storage.removeItem('sessionData');
                        storage.clear();
                        alert("New Data");
                        var jsonData = JSON.stringify(data);
                        document.getElementById("jsonData").value = jsonData;
                        encodeURIC = encodeURIComponent(JSON.stringify(data));
                        document.getElementById("encodeURIComponent").value = encodeURIC;
                        document.getElementById("decodeURIComponent").value = decodeURIComponent(encodeURIC);
                        document.getElementById("jsonParse").value = JSON.parse(decodeURIComponent(encodeURIC));
                    } else {
                        var jsonData = document.getElementById("jsonData").value;
                        document.getElementById("jsonData").value = jsonData;
                        encodeURIC = encodeURIComponent(jsonData);
                        document.getElementById("encodeURIComponent").value = encodeURIC;
                        document.getElementById("decodeURIComponent").value = decodeURIComponent(encodeURIC);
                        document.getElementById("jsonParse").value = JSON.parse(decodeURIComponent(encodeURIC));
                    }
                } catch ( e ) {
                    alert( e );  // バグの内容をダイアログで表示する
                    storage.setItem('errorData', e);
                    //alert("New Data");
                    var jsonData = JSON.stringify(data);
                    document.getElementById("jsonData").value = jsonData;
                    encodeURIC = encodeURIComponent(JSON.stringify(data));
                    document.getElementById("encodeURIComponent").value = encodeURIC;
                    document.getElementById("decodeURIComponent").value = decodeURIComponent(encodeURIC);
                    document.getElementById("jsonParse").value = JSON.parse(decodeURIComponent(encodeURIC));
                } finally {
                    //変数storageにsessionStorageを格納
                    storage.setItem('sessionData', encodeURIC);
                    alert("Save Data");
                }
            }
            changeJsondata(0);
            //useridというキーに1111という値を割り当てて保存
            //storage.setItem('sessionData', '1111');
            
            //後からvalueを変更してセットし直せば上書き保存される
            //storage.setItem('sessionData', '2222');
            
            //useridというキーの値を取得する（2222が返るはず）
            //storage.getItem('sessionData');
            
            //useridというキーの値を削除する
            //storage.removeItem('sessionData');
            
            //ストレージに保存されているデータをすべてクリアする
            //storage.clear();
        </script>
    </body>
</html>